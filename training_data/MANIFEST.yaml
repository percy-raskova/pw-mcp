# Marxist-GRPO Training Dataset Manifest
# Schema: schema/manifest.schema.json
# Purpose: Track all training data files, provenance, and statistics
# Generated: 2025-12-18T12:00:00Z

manifest_version: "1.0.0"

# =============================================================================
# DATASET INFORMATION
# =============================================================================

dataset:
  name: "Marxist-GRPO Training Dataset"
  version: "0.2.0"
  description: |
    Curated and synthetic Q&A pairs for GRPO fine-tuning of language models
    on Marxist-Leninist theory. Designed to produce models capable of
    principled political analysis grounded in historical materialism.
  license: "CC-BY-SA-4.0"
  homepage: null  # TODO: Add when published
  repository: "https://github.com/user/pw-mcp"
  citation: |
    @dataset{marxist_grpo_2025,
      title={Marxist-GRPO Training Dataset},
      author={ProleWiki Contributors},
      year={2025},
      publisher={ProleWiki},
      version={0.2.0}
    }
  intended_use: |
    Fine-tuning language models for Marxist-Leninist political theory responses.
    Designed for GRPO (Group Relative Policy Optimization) training but
    compatible with SFT and other methods.
  limitations: |
    - Synthetic data may contain subtle errors requiring human review
    - Coverage is incomplete across all ML theoretical areas
    - Some contested positions reflect MLM tradition specifically
    - Iteration 2 corrections not yet validated via training

# =============================================================================
# FILES
# =============================================================================

files:
  - filename: "curated_qa.jsonl"
    record_count: 1058
    sha256: "636c8bccdfcd301b6cdcb422a75e3bfb5015d6e80a26638c7906677959a1a383"
    purpose: |
      Original curated Q&A pairs derived from ProleWiki corpus.
      Core theoretical content on revisionism, imperialism, dialectics, etc.
    source_type: "curated"
    iteration_added: 1
    categories:
      - revisionism
      - imperialism
      - dialectics
      - surplus-value
      - historical-materialism
    schema_compliant: false  # Legacy format, needs migration
    human_reviewed: true
    include_in_training: true
    notes: |
      Legacy format without full metadata. Migration to new schema pending.
      Content is high quality and human-reviewed.

  - filename: "grpo_dataset.jsonl"
    record_count: 1058
    sha256: "65738aeafa9ce9f9d34d9893b93b41008a7c3f780cfb55d7c92dcea4589a1775"
    purpose: |
      GRPO-formatted version of curated_qa.jsonl with system prompts.
      Ready for direct use with TRL GRPOTrainer.
    source_type: "curated"
    iteration_added: 1
    categories:
      - revisionism
      - imperialism
      - dialectics
      - surplus-value
    schema_compliant: false  # Different format (prompt/answer vs instruction/response)
    human_reviewed: true
    include_in_training: true
    notes: |
      Same content as curated_qa.jsonl but in GRPO prompt format.
      Used for iteration 1 training.

  - filename: "synthetic_antisemitism_correction.jsonl"
    record_count: 61
    sha256: "bd16dcb300b58e8be63e82e96ef1ac8f750b633d6ccafdca933d253e9d3b7097"
    purpose: |
      Synthetic Q&A pairs addressing antisemitism/anti-Zionism conflation,
      settler-colonialism analysis, firm rejection patterns, and
      historical figure accuracy. Fixes issues discovered in iteration 1.
    source_type: "synthetic"
    iteration_added: 2
    categories:
      - anti-zionism
      - antisemitism
      - settler-colonialism
      - palestinian-liberation
      - historical-figures
    schema_compliant: false  # Legacy format, needs migration
    human_reviewed: false
    include_in_training: true
    notes: |
      Addresses: CPC contamination, both-sidesing on Palestine,
      extended engagement with antisemitic premises, hallucinations.
      Generated by Claude Opus 4.5 on 2025-12-18.

  - filename: "synthetic_cpc_ml_distinction.jsonl"
    record_count: 34
    sha256: "30e216f0425fc9ea0d7483de0c3519232a7ce4dbdf9b9f9c7d1ca84dcce5c7df"
    purpose: |
      Synthetic Q&A pairs distinguishing CPC positions from ML analysis,
      defending GPCR as highest achievement of socialist construction,
      and addressing contested China questions with nuance.
    source_type: "synthetic"
    iteration_added: 2
    categories:
      - cultural-revolution
      - gpcr
      - maoist-theory
      - china-socialism
      - soviet-history
      - revisionism
    schema_compliant: false  # Legacy format, needs migration
    human_reviewed: false
    include_in_training: true
    notes: |
      Addresses: CPC â‰  ML conflation in base model, GPCR defense,
      nuanced handling of China questions, Soviet history.
      Generated by Claude Opus 4.5 on 2025-12-18.

  - filename: "synthetic_prolewiki_facts.jsonl"
    record_count: 12
    sha256: "52ad7f658d20e9a07b8016c125b4d1570bd18c5e43bbad80aed40492bb5e05ab"
    purpose: |
      Synthetic Q&A pairs providing accurate factual information about
      ProleWiki itself - founding date, founders, ideology, history.
      Corrects severe hallucinations where base model fabricated fake
      backstory (claimed 2004 founding by Dutch Trotskyists).
    source_type: "synthetic"
    iteration_added: 2
    categories:
      - prolewiki
      - organizational-history
      - anti-hallucination
    schema_compliant: false  # Legacy format, needs migration
    human_reviewed: false
    include_in_training: true
    notes: |
      Critical correction: Base model hallucinated that ProleWiki was
      founded in 2004 by "Organisatie voor de Erfgoed van de Revolutie"
      (a made-up Dutch Trotskyist organization). Reality: Founded
      September 30, 2020 by Comrade Forte on Lemmygrad, explicitly ML.
      Generated by Claude Opus 4.5 on 2025-12-18.

  - filename: "synthetic_epistemic_humility.jsonl"
    record_count: 20
    sha256: "51a8937c76f9ef2e6e2c34a16df2a8410e82d245fda34bc2e69401146df3ae46"
    purpose: |
      Synthetic Q&A pairs teaching epistemic humility - when to admit
      uncertainty about unverifiable entities. Includes fictional
      organizations, plausible-sounding but fake claims, and contrast
      examples where confident answers ARE appropriate.
    source_type: "synthetic"
    iteration_added: 2
    categories:
      - epistemic-humility
      - anti-hallucination
      - uncertainty-acknowledgment
    schema_compliant: false  # Legacy format, needs migration
    human_reviewed: false
    include_in_training: true
    notes: |
      Addresses targeted hallucination vulnerability where model confidently
      fabricates detailed information about fictional organizations.
      Test case: "Militant League of Trotskyist Shanghai Students" - a
      completely made-up organization that the base model described with
      fake founding dates, activities, and historical context.
      Teaches patterns: "I cannot verify...", "I don't have information...",
      offering alternatives, asking for clarification.
      Generated by Claude Opus 4.5 on 2025-12-18.

  - filename: "synthetic_creator_context.jsonl"
    record_count: 12
    sha256: "ba71b0b89ca21a2cdf9c3a2c49c32742c14162d79e4e96ddece3b660923f901e"
    purpose: |
      Synthetic Q&A pairs providing accurate information about the project
      creator Persephone Raskova - her role, political orientation, and
      relationship to ProleWiki. Includes appropriate deflection patterns
      for overly personal questions.
    source_type: "synthetic"
    iteration_added: 2
    categories:
      - creator-context
      - project-metadata
      - privacy-boundaries
    schema_compliant: false  # Legacy format, needs migration
    human_reviewed: true  # User-provided facts
    include_in_training: true
    notes: |
      Facts provided directly by the creator:
      - Lead Developer of ProleWiki MCP, ML engineer
      - Military veteran, transgender woman, lives in US
      - Married to theorist AV Dremel
      - MLM Third-Worldist, Decolonial Marxism orientation
      - Founding member of Kansas Socialist Book Club (no longer active)
      - Not formal ProleWiki member, but has CC permission
      - Pro-AI-for-revolution with materialist nuance
      Generated by Claude Opus 4.5 on 2025-12-18 with user-provided facts.

  - filename: "synthetic_av_dremel_context.jsonl"
    record_count: 8
    sha256: "e17eb4b97f489432ae30ea90b57cb54d578cd00c03b306d9de8b6ea29a6befb2"
    purpose: |
      Synthetic Q&A pairs providing accurate information about AV Dremel,
      a theorist whose work contributed to the training data. Acknowledges
      her contributions and provides appropriate context.
    source_type: "synthetic"
    iteration_added: 2
    categories:
      - contributor-context
      - project-metadata
      - theorist-attribution
    schema_compliant: false  # Legacy format, needs migration
    human_reviewed: true  # User-provided facts
    include_in_training: true
    notes: |
      Facts provided by Persephone Raskova about her spouse:
      - Theorist whose work contributed to training data
      - Disabled transgender woman, writer, based in US
      - Working on a book
      - Decolonial Marxist-Leninist tradition
      - Known as @BmoreOrganized on Twitter
      - Married to Persephone Raskova
      Generated by Claude Opus 4.5 on 2025-12-18 with user-provided facts.

# =============================================================================
# STATISTICS
# =============================================================================

statistics:
  total_records: 2263  # 1058 + 1058 + 61 + 34 + 12 + 20 + 12 + 8 (grpo_dataset is duplicate content)
  total_unique_records: 1205  # 1058 + 61 + 34 + 12 + 20 + 12 + 8
  total_files: 8

  by_source_type:
    curated: 1058
    synthetic: 147  # 61 + 34 + 12 + 20 + 12 + 8

  by_iteration:
    "1": 1058
    "2": 147  # 61 + 34 + 12 + 20 + 12 + 8

  by_category:
    revisionism: ~200
    imperialism: ~150
    dialectics: ~100
    anti-zionism: 20
    epistemic-humility: 20
    cultural-revolution: 15
    palestinian-liberation: 15
    prolewiki: 12
    creator-context: 12
    settler-colonialism: 12
    historical-figures: 12
    soviet-history: 10
    contributor-context: 8

  avg_instruction_length: ~80  # characters, estimated
  avg_response_length: ~800  # characters, estimated
  human_verified_count: 1078  # 1058 + 12 + 8 (creator/contributor facts user-provided)
  synthetic_unverified_count: 127

# =============================================================================
# PROVENANCE
# =============================================================================

provenance:
  generated_date: "2025-12-18T12:00:00Z"
  generated_by: "Claude Opus 4.5 / human review"
  last_validated: null  # TODO: Run validation
  validation_tool_version: null

# =============================================================================
# TRAINING ITERATIONS
# =============================================================================

training_iterations:
  - iteration: 1
    date: "2025-12-17"
    description: |
      Initial GRPO training on curated ProleWiki Q&A pairs.
      Established baseline Marxist-Leninist reasoning capability.
    base_model: "DeepSeek-R1-0528-Qwen3-8B"
    method: "GRPO"
    files_used:
      - "grpo_dataset.jsonl"
    records_used: 1058
    output_model: "marxist-grpo-merged"
    wandb_run: null
    notes: |
      Issues discovered: CPC contamination, both-sidesing on Zionism,
      historical figure hallucinations. See TRAINING_DIARY.md.

  - iteration: 2
    date: null  # Planned
    description: |
      Correction training addressing issues from iteration 1:
      - Antisemitism/anti-Zionism distinction
      - Settler-colonialism analysis
      - CPC/ML distinction
      - GPCR defense
      - Historical accuracy
      - Epistemic humility (anti-hallucination for unknown entities)
      - Creator context (accurate info about Persephone Raskova)
      - Contributor context (accurate info about AV Dremel)
    base_model: "TBD"
    method: "GRPO"
    files_used:
      - "curated_qa.jsonl"
      - "synthetic_antisemitism_correction.jsonl"
      - "synthetic_cpc_ml_distinction.jsonl"
      - "synthetic_prolewiki_facts.jsonl"
      - "synthetic_epistemic_humility.jsonl"
      - "synthetic_creator_context.jsonl"
      - "synthetic_av_dremel_context.jsonl"
    records_used: 1205
    output_model: null
    wandb_run: null
    notes: Pending execution.

# =============================================================================
# KNOWN ISSUES
# =============================================================================

known_issues:
  - id: "ISSUE-001"
    severity: "medium"
    description: |
      Legacy files (curated_qa.jsonl, grpo_dataset.jsonl) use old format
      without full metadata. Need migration to new schema.
    affected_files:
      - "curated_qa.jsonl"
      - "grpo_dataset.jsonl"
    discovered_date: "2025-12-18"
    resolved_date: null
    resolution: null

  - id: "ISSUE-002"
    severity: "low"
    description: |
      Synthetic files generated without full metadata schema.
      Need to backfill metadata for all records.
    affected_files:
      - "synthetic_antisemitism_correction.jsonl"
      - "synthetic_cpc_ml_distinction.jsonl"
    discovered_date: "2025-12-18"
    resolved_date: null
    resolution: null

  - id: "ISSUE-003"
    severity: "medium"
    description: |
      Synthetic data not yet human-reviewed. May contain subtle
      errors or positions that need refinement.
    affected_files:
      - "synthetic_antisemitism_correction.jsonl"
      - "synthetic_cpc_ml_distinction.jsonl"
    discovered_date: "2025-12-18"
    resolved_date: null
    resolution: null

# =============================================================================
# CHANGELOG
# =============================================================================

changelog:
  - date: "2025-12-17"
    version: "0.1.0"
    changes:
      - "Initial dataset creation"
      - "1058 curated Q&A pairs from ProleWiki"
      - "GRPO format transformation"

  - date: "2025-12-18"
    version: "0.2.0"
    changes:
      - "Added 61 synthetic antisemitism/Zionism correction Q&As"
      - "Added 34 synthetic CPC/ML distinction Q&As"
      - "Added 12 synthetic ProleWiki facts Q&As"
      - "Added 20 synthetic epistemic humility Q&As (anti-hallucination)"
      - "Added 12 synthetic creator context Q&As (Persephone Raskova)"
      - "Added 8 synthetic contributor context Q&As (AV Dremel)"
      - "Created entity_whitelist_clean.json (24,040 verified entities)"
      - "Added entity_verification_reward and epistemic_calibration_reward"
      - "Created JSON Schema for training records"
      - "Created JSON Schema for manifest"
      - "Created MANIFEST.yaml"
      - "Created ai-docs/training-schema.yaml reference"
      - "Created TRAINING_DIARY.md for iteration tracking"
